<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"><title data-react-helmet="true">4.1 The Tangle | IOTA-2.0-Research-Specifications</title><meta data-react-helmet="true" property="og:url" content="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/4.1 The Tangle"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="4.1 The Tangle | IOTA-2.0-Research-Specifications"><meta data-react-helmet="true" name="description" content="This specification describes the data structure used in the IOTA protocol, and introduces its main terminology."><meta data-react-helmet="true" property="og:description" content="This specification describes the data structure used in the IOTA protocol, and introduces its main terminology."><link data-react-helmet="true" rel="shortcut icon" href="/IOTA-2.0-Research-Specifications/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/4.1 The Tangle"><link data-react-helmet="true" rel="alternate" href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/4.1 The Tangle" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/4.1 The Tangle" hreflang="x-default"><link rel="stylesheet" href="/IOTA-2.0-Research-Specifications/assets/css/styles.e42a1e77.css">
<link rel="preload" href="/IOTA-2.0-Research-Specifications/assets/js/runtime~main.6d56e3c9.js" as="script">
<link rel="preload" href="/IOTA-2.0-Research-Specifications/assets/js/main.4593505c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/IOTA-2.0-Research-Specifications/"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link navbar__link--active" href="/IOTA-2.0-Research-Specifications/docs/preface">Specification</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/IOTA-2.0-Research-Specifications/"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/IOTA-2.0-Research-Specifications/docs/preface">Specification</a></li><li class="menu__list-item"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/preface">Preface</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/1.1 Introduction">1.1 Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/2.2 Message Layout">2.2 Message Layout</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/2.3 Standard Payloads Layout">2.3 Standard Payloads Layout</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/2.4 Data Flow">2.4 Data flow</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/3.3 Peer Discovery">3.3 Peer Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/3.4 Neighbor Selection">3.4 Neighbor Selection</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/IOTA-2.0-Research-Specifications/docs/4.1 The Tangle">4.1 The Tangle</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.2 Timestamps">4.2 Timestamps</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.3 Tip Selection Algorithm">4.3 Tip Selection Algorithm</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.4 Solidification">4.4 Solidification</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.5 Rate Control">4.5 Rate Control through Adaptive Proof of Work</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.6 Congestion Control">4.6 Congestion control</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.7 Markers">4.7 Markers</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/5.1 UTXO">5.1 UTXO</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/5.2 Ledger State">5.2 Ledger State</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/5.3 Mana">5.3 Mana</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.1 Objects of Consensus">6.1 Objects of Consensus</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.2 Opinion Setting">6.2 Opinion Setting</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.3 Fast Probabilistic Consensus">6.3 Fast Probabilistic Consensus</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.4 Finalization">6.4 Approval Weight and Finality</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.5 dRNG">6.5 Distributed Random Number Generator</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">4.1 The Tangle</h1></header><p>This specification describes the data structure used in the IOTA protocol, and introduces its main terminology.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="411-description"></a>4.1.1 Description<a class="hash-link" href="#411-description" title="Direct link to heading">#</a></h2><p>The Tangle represents a growing partially-ordered set of messages, linked with each other through cryptographic primitives, and replicated to all nodes in the peer-to-peer network. The Tangle enables the possibility to store data and to keep a ledger, the latter being based on UTXO-DAG formed by transactions contained in messages.</p><p>In mathematical terms, the Tangle is a Directed Acyclic (multi)Graph with messages as vertices and directed edges as references to existing messages.
Directed edges are labelled: $0$ represents direct references flagged as <em>weak</em>, and $1$ represents direct references flagged as <em>strong</em> (see [Section 6.4 - Finalization](./6.4 Finalization.md). Messages are linked with each other through cryptographic hashes.
The acyclicity condition means that there is no directed cycle composed of weak or strong edges.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="412-definitions"></a>4.1.2 Definitions<a class="hash-link" href="#412-definitions" title="Direct link to heading">#</a></h2><p>In this section we provide some useful terminology which is useful to understand the basic elements of the protocol.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4121-approval-switch"></a>4.1.2.1 Approval switch<a class="hash-link" href="#4121-approval-switch" title="Direct link to heading">#</a></h3><p>Here we present the set of rules, called <em>approval switch</em>, which allow nodes to alternatively approve single messages or the entire past cone of a message.</p><ul><li><p><strong>Parent</strong>: The protocol requires that each message contains a field <code>parents</code> in order to guarantee cryptographic references among messages in the Tangle. These references can be of two types, <em>strong</em> and <em>weak</em>, and are defined by the field <code>parents type</code>. Intuitively, we say that $y$ is a <em>strong</em> (resp. <em>weak</em>) <em>parent</em> of a message $x$ if $x$ has a directed strong (resp. weak) edge to $y$. Each message has a possible number of parents from 2 to 8 with repetitions (with 2 as a default value), where at least one is a strong parent. More information about parents can be found in [Section 2.2 - Message layout](./2.2 Message Layout.md).</p></li><li><p><strong>Approvers</strong>: A message $x$ <em>directly approves</em> $y$ if $y$ is a parent of $x$. Moreover, $x$ is a <em>strong</em> (resp. <em>weak</em>) <em>approver</em> of $y$ if $y$ is a strong (resp. weak) parent of $x$. More generally, we say that a message $x$ <em>strongly approves</em> $y$ if there is a directed path of strong approvals from $x$ to $y$, and $x$ <em>weakly approves</em> $y$ if there is a directed path of approvals of any type from $x$ to $y$.</p></li><li><p><strong>Past cone</strong>: We say that the <em>(strong) past cone</em> of $x$ is the set of all messages strongly approved by $x$, and the <em>weak past cone</em> of $x$ is the set of all messages weakly or strongly approved by $x$. </p></li><li><p><strong>Future cone</strong>: We define the <em>future cone</em> of a message $x$ as the set of messages that weakly or strongly approve $x$. Please note that, unlike its past cone, the future cone of a message changes over time.</p></li><li><p><strong>Genesis</strong>: The genesis is the message that creates the entire token supply. Note that this implies that no other tokens will ever be created or, equivalently, no mining occurs. This message has no outgoing edges and is in the weak past cone of every other message.</p></li></ul><p>In short, strong approvals are equivalent to the approvals in the legacy IOTA: if $x$ strongly approves $y$, it approves also $y$&#x27;s past cone. Moreover, weak approvals emulate the <a href="https://github.com/iotaledger/protocol-rfcs/blob/master/text/0005-white-flag/0005-white-flag.md" target="_blank" rel="noopener noreferrer">White Flag</a> approach from Chrysalis: approving a message does not necessarily approve its past cone. This feature allows, for instance, two conflicting messages to be part of the Tangle without creating unmergeable branches.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4122-validity"></a>4.1.2.2 Validity<a class="hash-link" href="#4122-validity" title="Direct link to heading">#</a></h3><p>This subsection introduces the definitions of validity for transactions and messages.</p><ul><li><p><strong>(Transaction) Validity</strong>: A transaction is valid if it passes the syntactical filter and its references are valid (see [Section 2.3 - Payloads Layout](./2.3 Standard Payloads Layout.md) for information):</p><ul><li>It is syntactically correct.</li><li>Unblock conditions are met (see [Section 5.1 - UTXO](./5.1 UTXO.md) for further information).</li><li>Balances are zero, i.e., the sum of the inputs in the transaction&#x27;s payload is equal to the sum of the outputs spent.</li><li>No conflicts in the past cone on the UTXO DAG (two transactions <em>conflict</em> if they consume the same UTXO output).</li></ul></li><li><p><strong>(Message) Individual Validity</strong>: A message is considered individually valid if it passes all the objective filters, i.e. the ones included in the Message Parser (see [Section 2.4 - Data Flow](./2.4 Data flow.md)):</p><ul><li>It is syntactically correct.</li><li>Its signature is valid.</li><li>Its Proof of Work is correct.</li></ul></li><li><p><strong>(Message) Weak Validity</strong>: A message is weakly valid if:</p><ul><li>Its Individually Valid.</li><li>Its parents are weakly valid.</li><li>Its transaction is valid.</li><li>It passes the Parent Age Check.</li></ul></li><li><p><strong>(Message) Strong Validity</strong>: A message is strongly valid if:</p><ul><li>It is weakly valid.</li><li>Its strong parents do not have a conflicting past.</li><li>Its strong parents are strongly valid.</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4123-branches"></a>4.1.2.3 Branches<a class="hash-link" href="#4123-branches" title="Direct link to heading">#</a></h3><p>In the IOTA protocol, multiple version of the ledger state can temporarily coexist. These multiple versions of the ledger state are called <em>branches</em>. As soon as conflicts are detected, new branches are generated where the outputs created by conflicting transactions and those created by transactions that spend these outputs are tracked. If all past conflicts are resolved and no new conflicts are detected, then only one branch will exist. More rigorously, we can refer to a branch as a non-conflicting collection of past cones of outputs in the UTXO DAG. Additional information, as well as the distinction between conflict and aggregated branches, is given in [Section 5.2 - Ledger state](./5.2 Ledger State.md).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4122-solidification"></a>4.1.2.2 Solidification<a class="hash-link" href="#4122-solidification" title="Direct link to heading">#</a></h3><p>Due to the asynchronicity of the network, we may receive messages for which their past cone has missing elements. We refer to these messages as <em>unsolid</em> messages. It is not possible neither to approve nor to gossip unsolid messages. The actions required to obtain such missing messages is called <em>solidification procedure</em>, and are described in detail in [Section 4.4 - Solidification](./4.4 Solidification.md).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="413-example"></a>4.1.3 Example<a class="hash-link" href="#413-example" title="Direct link to heading">#</a></h2><p>Image 4.1.1 shows an example of the Tangle (strong edges are with a continuous line, weak edges are with a dotted line). Message $D$ contains a transaction that has been rejected. Thus, in the legacy IOTA implementation, its future cone would be orphaned due to the monotonicity rule. In particular, both messages $E$ (data) and $F$ (transaction) directly reference $D$. In IOTA 2.0, the introduction of the approval switch allows that these messages can be picked up via a weak approval, as messages $G$ and $H$ exemplify.</p><p><img src="https://imgur.com/Rv1zXFI.png"></p><p><strong>Image 4.1.1:</strong> Example of the IOTA Tangle.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/edit/master/website/docs/4.1 The Tangle.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/IOTA-2.0-Research-Specifications/docs/3.4 Neighbor Selection"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 3.4 Neighbor Selection</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/IOTA-2.0-Research-Specifications/docs/4.2 Timestamps"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">4.2 Timestamps Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#411-description" class="table-of-contents__link">4.1.1 Description</a></li><li><a href="#412-definitions" class="table-of-contents__link">4.1.2 Definitions</a><ul><li><a href="#4121-approval-switch" class="table-of-contents__link">4.1.2.1 Approval switch</a></li><li><a href="#4122-validity" class="table-of-contents__link">4.1.2.2 Validity</a></li><li><a href="#4123-branches" class="table-of-contents__link">4.1.2.3 Branches</a></li><li><a href="#4122-solidification" class="table-of-contents__link">4.1.2.2 Solidification</a></li></ul></li><li><a href="#413-example" class="table-of-contents__link">4.1.3 Example</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Specification</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/IOTA-2.0-Research-Specifications/docs/preface">Specification</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.iota.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/iota" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://iota.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Exchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation. Built with Docusaurus.</div></div></div></footer></div>
<script src="/IOTA-2.0-Research-Specifications/assets/js/runtime~main.6d56e3c9.js"></script>
<script src="/IOTA-2.0-Research-Specifications/assets/js/main.4593505c.js"></script>
</body>
</html>