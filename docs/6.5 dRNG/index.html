<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons"><title data-react-helmet="true">6.5 Distributed Random Number Generator | IOTA-2.0-Research-Specifications</title><meta data-react-helmet="true" property="og:url" content="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/6.5 dRNG"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="6.5 Distributed Random Number Generator | IOTA-2.0-Research-Specifications"><meta data-react-helmet="true" name="description" content="6.5.1 Introduction"><meta data-react-helmet="true" property="og:description" content="6.5.1 Introduction"><link data-react-helmet="true" rel="shortcut icon" href="/IOTA-2.0-Research-Specifications/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/6.5 dRNG"><link data-react-helmet="true" rel="alternate" href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/6.5 dRNG" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/IOTA-2.0-Research-Specifications/docs/6.5 dRNG" hreflang="x-default"><link rel="stylesheet" href="/IOTA-2.0-Research-Specifications/assets/css/styles.e42a1e77.css">
<link rel="preload" href="/IOTA-2.0-Research-Specifications/assets/js/runtime~main.6d56e3c9.js" as="script">
<link rel="preload" href="/IOTA-2.0-Research-Specifications/assets/js/main.4593505c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/IOTA-2.0-Research-Specifications/"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link navbar__link--active" href="/IOTA-2.0-Research-Specifications/docs/preface">Specification</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/IOTA-2.0-Research-Specifications/"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/IOTA-2.0-Research-Specifications/img/logo.svg" alt="IOTA-2.0-Research-Specifications" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/IOTA-2.0-Research-Specifications/docs/preface">Specification</a></li><li class="menu__list-item"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/preface">Preface</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/1.1 Introduction">1.1 Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/2.2 Message Layout">2.2 Message Layout</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/2.3 Standard Payloads Layout">2.3 Standard Payloads Layout</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/2.4 Data Flow">2.4 Data flow</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/3.3 Peer Discovery">3.3 Peer Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/3.4 Neighbor Selection">3.4 Neighbor Selection</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.1 The Tangle">4.1 The Tangle</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.2 Timestamps">4.2 Timestamps</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.3 Tip Selection Algorithm">4.3 Tip Selection Algorithm</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.4 Solidification">4.4 Solidification</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.5 Rate Control">4.5 Rate Control through Adaptive Proof of Work</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.6 Congestion Control">4.6 Congestion control</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/4.7 Markers">4.7 Markers</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/5.1 UTXO">5.1 UTXO</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/5.2 Ledger State">5.2 Ledger State</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/5.3 Mana">5.3 Mana</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.1 Objects of Consensus">6.1 Objects of Consensus</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.2 Opinion Setting">6.2 Opinion Setting</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.3 Fast Probabilistic Consensus">6.3 Fast Probabilistic Consensus</a></li><li class="menu__list-item"><a class="menu__link" href="/IOTA-2.0-Research-Specifications/docs/6.4 Finalization">6.4 Approval Weight and Finality</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/IOTA-2.0-Research-Specifications/docs/6.5 dRNG">6.5 Distributed Random Number Generator</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">6.5 Distributed Random Number Generator</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="651-introduction"></a>6.5.1 Introduction<a class="hash-link" href="#651-introduction" title="Direct link to heading">#</a></h2><p>The module presented in this specification allows for the distributed generation of randomness for the post-Coordicide IOTA network. The distributed random number generator (dRNG) protocol is divided into three phases:</p><ol><li><p>COMMITTEE SELECTION: In the first phase, a committee of high Consensus Mana nodes is selected. The procedure is objective i.e., all of the nodes in the network reach a consensus on which nodes should be in the committee.
In order for a node to be considered as a candidate to the committee, it needs to declare its willingness to participate, with a special <em>application message</em>. When all of the required application messages are recorded in the Tangle, the <code>committeeNodes</code> top consensus Mana holders among the candidates are selected as the committee. In the case where some of the required messages fail to be produced, the committee selection will consequently fail as well.</p></li><li><p>DKG PHASE: In the second setup phase, the committee members create a collective private key which will be used later to generate the random number, using the $(t,n)$ Distributed Key Generation (DKG), that does not rely on centralized, trusted third parties. The participation of the nodes in this phase can be publicly verified since the messages exchange takes place in the Tangle. </p></li><li><p>PUBLICATION PHASE: This last phase consists of the periodical publication of the beacon messages in the Tangle. A single individual beacon message should not be sufficient to reveal the random number; instead, the beacon messages from at least $t$ out of $n$ committee members are needed for the next random number being revealed. Additionally, the committee members publish a collective beacon message, which would contain the random number. </p></li></ol><p>A large part of the procedures in this specification is based on the article <a href="https://arxiv.org/abs/2102.03139" target="_blank" rel="noopener noreferrer">Committee selection in DAG distributed ledgers and applications</a>, where authors discuss multiple methods of the committee selection and applications.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="652-dependencies"></a>6.5.2 Dependencies<a class="hash-link" href="#652-dependencies" title="Direct link to heading">#</a></h2><p>The dRNG module depends on the [Section 5.3 - Mana](./5.3 Mana.md) since it uses the Consensus Mana (cMana) vector as a measure of trustworthiness. Specifically, it uses the list of the top cMana holders to select a committee to produce the random numbers. During the committee selection, we do not assume a perfect agreement on the cMana values, i.e., different nodes can have slightly different perceptions of the cMana values of other nodes (due to the different local clocks). Obtaining consensus on the cMana values is the central part of this documentation. </p><p>The random numbers produced by dRNG are used in [Section 6.3 - Fast Probabilistic Consensus](./6.3 Fast Probabilistic Consensus.md).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="653-parameters"></a>6.5.3 Parameters<a class="hash-link" href="#653-parameters" title="Direct link to heading">#</a></h2><p><strong>Table 6.5.1  dRNG parameters</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Value</th></tr></thead><tbody><tr><td><code>rnPeriod</code></td><td>duration</td><td>Random number is produced every<code>rnPeriod</code> seconds</td><td>20 [sec]</td></tr><tr><td><code>committeeNodes</code></td><td>integer</td><td>Number of nodes in the committee</td><td>10 [nodes]</td></tr><tr><td><code>committeeSeats</code></td><td>integer</td><td>The number of identities (seats) in the top Mana holders committee equals <code>committeeSeats</code>. It is different from <code>committeeNodes</code> because some of the nodes receive double seats in the committee.</td><td>15   [seats]</td></tr><tr><td><code>sigThreshold</code></td><td>integer</td><td>Signature threshold parameter (number of beacon messages needed to obtain randomness)</td><td>8 [messages] ([seats])</td></tr><tr><td><code>committeeUpdate</code></td><td>duration</td><td>Period of committee update</td><td>1 [day] = 86400 [sec]</td></tr><tr><td><code>applicationWindow</code></td><td>duration</td><td>Time window of the &#x27;&#x27;application&#x27;&#x27; message submission</td><td>120 [sec]</td></tr><tr><td><code>TIMESTAMP_CUTOFF</code></td><td>duration</td><td>Message timestamp cutoff (Assuming the node is in sync, the time after which point the node will receive no new messages with a particular timestamp which will be finalized)</td><td>2<code>DLARGE</code> +<code>W</code>= 90[sec]</td></tr></tbody></table><p> For more information on the <code>TIMESTAMP_CUTOFF</code>  see section [Section 4.2 -  Timestamps](./4.2 Timestamps.md)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="654--committee-selection"></a>6.5.4  Committee selection<a class="hash-link" href="#654--committee-selection" title="Direct link to heading">#</a></h2><p>To select the committee based on the cMana, we need to achieve consensus on these values. To solve this problem, we use epochs a reference point which can be used to calculate the cMana values in an objective manner. </p><p>The willingness to participate in the committee is announced with a special application message, which like any other transactions in the Tangle are equipped with timestamps. Since the nodes following the protocol judge and invalidate messages which timestamps are too off, we can assume that the application messages can reliably give us a list of nodes interested in joining the committee. </p><p> The committee selection process starts at the time $t_S$ and should be done (assuming no problems occur) at the time $t_F$. The time $t_F$ is determined by the committee update time, $t_S$ depends also on the <code>applicationWindow</code> and <code>TIMESTAMP_CUTOFF</code>.</p><p> Only nodes that are in synch with the network should participate in the committee selection. If a node is out of synch (<code>SyncStatus = FALSE</code>) it should skip this committee selection. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6541-application-messages"></a>6.5.4.1 Application messages<a class="hash-link" href="#6541-application-messages" title="Direct link to heading">#</a></h3><p>Any node can issue an application message. Such a message would be processed by the nodes (assuming it passes the congestion control, along with other checks). However, for a low mana node, there is no incentive to apply for the committee, as the probability of being selected is very low; hence, they can decide to not take part in sending application messages. Although it is allowed, sending multiple application messages is pointless and costly due to the congestion control mechanism.  </p><p>For brevity denote <code>TIMESTAMP_CUTOFF</code> by $\Delta<em>C$ and <code>applicationWindow</code> by $\Delta_A$. Assume that a committee should be formed at the time $t_F$ (which is known to all interested nodes; it is defined on the protocol level). Assume further that the time $t_F$ is in the epoch $E$ i.e., $t_F$ $\in$ $[t</em>{E-1}$,$t<em>E]$. Then the active consensus Mana vector from the time $t</em>{E-2}$ is calculated,  which is the balance from two epochs before $t_F$. The committee selection process starts with the opening of the application message window at the time $t_S$, where $t_S$ = $t_F$-$\Delta_A$ -2$\Delta_C$. For as long as the application window is open, nodes can issue application messages. See the subsection &quot;6.5.3.1 Application message sending - default algorithm&quot; for the proposed algorithm of issuing application messages (which is not enforceable). </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6542-application-message-sending---default-algorithm"></a>6.5.4.2 Application message sending - default algorithm<a class="hash-link" href="#6542-application-message-sending---default-algorithm" title="Direct link to heading">#</a></h3><p>A node is said to be $M<em>\ell$ if its consensus Mana rank is less or equal to $\ell$ (node is among $\ell$ top Mana nodes). Computation of node&#x27;s Mana rank is taking place with respect to the time from two epochs ago i.e., with respect to $t</em>{E-2}$ under the assumption that $t<em>S \in [t</em>{E-1},t_E]$.</p><p>For brevity denote <code>committeeNodes</code> by $m$. If an interested node $x$ is $M<em>{2m}$ then it issues an application at the time $t_S$. Notice that, in general, not all of the $2m$ application messages will be sent (due to for example nodes going offline or malfunction). If less than $m$ strongly valid application messages are sent at $T_S$, the nodes that are $M</em>{3m}$ (but not $M<em>{2m}$) issue their application messages at the time  $T_S- \Delta_A \frac{1}{2}$ and so on. In general, for $k&gt;2$, if a node $x$ which is $M</em>{m k}$ but not $M_{m (k-1)}$, it submits a committee application whenever before the time $T_S- \Delta_A \frac{k-2}{k-1}$ there are less than $m$ strongly valid application messages with cMana greater than the cMana of node $x$.  </p><p>See subsection <strong>6.5.9 Pseudocodes</strong> for the pseudocodes of the default application message sending procedure.</p><p>If at least $m$ of the nodes sent an application message within the time interval, the committee is formed from the top $m$ Mana nodes who applied. Due to the network delay, this can be confirmed only at the time $t_S+\Delta_A+\Delta_C$.  </p><p>If less than $m$ nodes send application messages, then the committee selection will fail. This is confirmed at the time $t_S+\Delta_A+\Delta_C$. In this case, the procedure should be repeated immediately, with new starting time $t&#x27;_S$ and finish time $t&#x27;_F$ such $t&#x27;_S =t_S+\Delta_A+\Delta_C$ and $t&#x27;_F=t_F+\Delta_A+\Delta_C$. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="655-dkg-phase"></a>6.5.5 DKG phase<a class="hash-link" href="#655-dkg-phase" title="Direct link to heading">#</a></h2><p>After a successful committee selection, confirmed at the time $t_S+\Delta_C+\Delta_A$ with respect to the node&#x27;s local clock, the DKG phase starts. In this phase, the committee nodes exchange the <em>Deal messages</em> to produce a public/private collective key. There is no time window for the DKG phase and nodes should proceed with the corresponding  DKG message exchange as soon as the committee selection is confirmed (time $t_S+\Delta_C+\Delta_A$). Only DKG messages with this timestamp are accepted. </p><p>If any of the committee nodes refuse to create a collective key pair by not exchanging the  Deal DKG messages, the DKG phase fails. This can be confirmed at the time $t_F= $t_S+2\Delta_C+\Delta_A$. Moreover, since the message exchange occurs on the Tangle, everybody can identify the nodes that caused the failure. In the case of DKG phase failure, the entire committee selection is repeated (including the application phase). New start and finish time are $t&#x27;_S = t_F= $t_S+2\Delta_C+\Delta_A$ and $t&#x27;_F= t_F+2\Delta_C+\Delta_A$. The malicious node is then excluded from the new committee selection - all application messages issued by a malicious node are ignored. Ban on the committee application is lifted after a successful committee selection i.e., the committee produces its first beacon messages. In other words, if a node failed to produce a DKG message (either due to malfunction or maliciousness) it cannot apply to be in the current committee, however, it can apply in the next committee selection process. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="656-double-seats"></a>6.5.6 Double seats<a class="hash-link" href="#656-double-seats" title="Direct link to heading">#</a></h2><p>We can increase the security of the dRNG beacon by granting double seats to half of the committee members that have the highest committee Mana. Those nodes would receive two private keys (identities) with which they sign beacon messages in the Tangle. From the technical point of view, the two seats are completely separate, and issued Beacon messages can not be combined (even though they were signed by the same node). This modification increases the amount of Mana required to &quot;overtake&quot; the committee, which is understood as gaining <code>sigThreshold</code> of seats in the committee. </p><p>The number of nodes in the committee with double seats equals $\lfloor m/2 \rfloor$ (top half of the committee nodes). The total number of identities in the committee equals $m + \lfloor m/2 \rfloor$.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="657-publication-of-the-random-number"></a>6.5.7 Publication of the random number<a class="hash-link" href="#657-publication-of-the-random-number" title="Direct link to heading">#</a></h2><p>The committee will collectively generate a random number based on the set of beacon messages that each node will individually produce. A single beacon message is not sufficient to reveal the random number; instead,  <code>sigThreshold</code> or more beacon messages are needed for the next random number to be revealed. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6571-collective-beacon-message"></a>6.5.7.1 Collective beacon message<a class="hash-link" href="#6571-collective-beacon-message" title="Direct link to heading">#</a></h3><p>To recover the random number from the individual beacon messages, all nodes in the network would need to perform Lagrange interpolation. To avoid that, we propose that the committee nodes produce a <em>collective beacon message</em>, which contains a pre-computed random number (meaning that the committee nodes perform the Lagrange interpolation on their own). Since the committee size is small and the expected throughput of the network is large, we require all committee members to produce this collective beacon message as soon as they receive <code>sigThreshold</code> individual beacon messages. </p><p>The cost of getting randomness from the collective beacon would be reduced as only (additionally to the default message checks) the signature verification would be required.  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="658-duties-of-the-old-committee"></a>6.5.8 Duties of the old committee<a class="hash-link" href="#658-duties-of-the-old-committee" title="Direct link to heading">#</a></h2><p>An old committee should only stop producing randomness if another committee was successfully selected and started producing random numbers, which will be confirmed when the first collective beacon message is produced by the new committee and can be read directly from the Tangle.   </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="659-alternative-drng-and-backup-options"></a>6.5.9 Alternative dRNG and backup options<a class="hash-link" href="#659-alternative-drng-and-backup-options" title="Direct link to heading">#</a></h2><p>To increase the liveness of the random number production multiple dRNGs may be deployed. Secondary dRNGs can be used if the primary one is not available; it is also possible that users alternate between random numbers from multiple dRNGs. </p><p>However, this discussion is out of the scope of this specification document. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6510-pseudocodes"></a>6.5.10 Pseudocodes<a class="hash-link" href="#6510-pseudocodes" title="Direct link to heading">#</a></h2><p>Actions after receiving incoming transaction which is an application message:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly vbnet"><pre tabindex="0" class="prism-code language-vbnet codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">IF (NOT IsBlacklisted(IssuingNode(tx)))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   IF (Mana(IssuingNode(tx),E-2) &gt; Mana(My_node,E-2))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      numberValidApplicationMessagesWithManaHigherThanMine ++ </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Actions of a node interested in committee participation:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly vbnet"><pre tabindex="0" class="prism-code language-vbnet codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">IF (thisNodeWantsToParticipateInDRNG)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   WaitUntil (tS)  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ell = GetManaRank(myNode,Epoch-2)  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ApplicationMessageSend(ell)  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly vbnet"><pre tabindex="0" class="prism-code language-vbnet codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">FUNCTION ApplicationMessageSend(ell)  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    IF (ell &lt;= 2m)  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        SendApplicationMessage()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ELSE  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        WaitUntil(T_S- applicationWindow *[1-(floor(ell/m)-2)/(floor(ell/m)-1)])  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        IF (numberValidApplicationMessagesWithManaHigherThanMine &lt; m)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SendApplicationMessage()</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6511-payload-layout"></a>6.5.11 Payload layout<a class="hash-link" href="#6511-payload-layout" title="Direct link to heading">#</a></h2><p>DRNG payload layout is discussed in [Section 2.3 - Standard Payloads Layout](./2.3 Standard Payloads Layout.md#2.3.5.5-drng-application-message).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/edit/master/website/docs/6.5 dRNG.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/IOTA-2.0-Research-Specifications/docs/6.4 Finalization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 6.4 Approval Weight and Finality</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#651-introduction" class="table-of-contents__link">6.5.1 Introduction</a></li><li><a href="#652-dependencies" class="table-of-contents__link">6.5.2 Dependencies</a></li><li><a href="#653-parameters" class="table-of-contents__link">6.5.3 Parameters</a></li><li><a href="#654--committee-selection" class="table-of-contents__link">6.5.4  Committee selection</a><ul><li><a href="#6541-application-messages" class="table-of-contents__link">6.5.4.1 Application messages</a></li><li><a href="#6542-application-message-sending---default-algorithm" class="table-of-contents__link">6.5.4.2 Application message sending - default algorithm</a></li></ul></li><li><a href="#655-dkg-phase" class="table-of-contents__link">6.5.5 DKG phase</a></li><li><a href="#656-double-seats" class="table-of-contents__link">6.5.6 Double seats</a></li><li><a href="#657-publication-of-the-random-number" class="table-of-contents__link">6.5.7 Publication of the random number</a><ul><li><a href="#6571-collective-beacon-message" class="table-of-contents__link">6.5.7.1 Collective beacon message</a></li></ul></li><li><a href="#658-duties-of-the-old-committee" class="table-of-contents__link">6.5.8 Duties of the old committee</a></li><li><a href="#659-alternative-drng-and-backup-options" class="table-of-contents__link">6.5.9 Alternative dRNG and backup options</a></li><li><a href="#6510-pseudocodes" class="table-of-contents__link">6.5.10 Pseudocodes</a></li><li><a href="#6511-payload-layout" class="table-of-contents__link">6.5.11 Payload layout</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Specification</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/IOTA-2.0-Research-Specifications/docs/preface">Specification</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.iota.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/iota" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://iota.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Exchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation. Built with Docusaurus.</div></div></div></footer></div>
<script src="/IOTA-2.0-Research-Specifications/assets/js/runtime~main.6d56e3c9.js"></script>
<script src="/IOTA-2.0-Research-Specifications/assets/js/main.4593505c.js"></script>
</body>
</html>